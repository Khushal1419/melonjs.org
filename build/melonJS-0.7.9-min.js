/*!
 * @fileoverview 
 * MelonJS Game Engine
 * or... my humble attempt to create a game/app engine :)
 *
 * Minified version
 *
 * Copyright (C) 2011, Olivier BIOT
 * http://www.melonjs.org
 * 
 * melonJS is licensed under a Creative Commons 
 * Attribution-NonCommercial-NoDerivs 3.0 Unported License.
 * http://creativecommons.org/licenses/by-nc-nd/3.0/
 *
 * @author Olivier Biot
 * @author 2011
 */
(function(a,b){var l=a.document;a.me={mod:"melonJS",nocache:"",sys:{ua:navigator.userAgent.toLowerCase(),sound:false,storage:false,gyro:(a.DeviceMotionEvent!==b),fps:60,interpolation:false,scale:1,useNativeAnimFrame:false},debug:{displayFPS:false,renderHitBox:false},audio:null,video:null,timer:null,input:null,state:null,game:null,entityPool:null,levelDirector:null,XMLParser:null,loadingScreen:null,TMXTileMap:null};var q=false;var t=false,m=false,h=[];function g(){if(!m){if(!l.body){return setTimeout(g,13)}if(l.removeEventListener){l.removeEventListener("DOMContentLoaded",g,false)}else{a.removeEventListener("load",g,false)}m=true;for(var w=0;w<h.length;w++){h[w].call(a,[])}h=[]}}function v(){if(t){return}t=true;if(l.addEventListener){l.addEventListener("DOMContentLoaded",g,false)}a.addEventListener("load",g,false)}onReady=function(w){v();if(m){w.call(a,[])}else{h.push(function(){return w.call(a,[])})}return this};a.onReady(function(){i()});var j=false,f=/xyz/.test(function(){xyz})?/\bparent\b/:/.*/;Object.extend=function(A){var y=this.prototype;j=true;var z=new this();j=false;for(var x in A){z[x]=typeof A[x]=="function"&&typeof y[x]=="function"&&f.test(A[x])?(function(B,C){return function(){var E=this.parent;this.parent=y[B];var D=C.apply(this,arguments);this.parent=E;return D}})(x,A[x]):A[x]}function w(){if(!j&&this.init){this.init.apply(this,arguments)}}w.prototype=z;w.constructor=w;w.extend=arguments.callee;return w};if(typeof Object.create!=="function"){Object.create=function(w){function x(){}x.prototype=w;return new x()}}if(!Function.bind){Function.prototype.bind=function(x){var w=this;return function(){return w.apply(x,arguments)}}}String.prototype.trim=function(){return(this.replace(/^\s+/,"")).replace(/\s+$/,"")};String.prototype.isNumeric=function(){return(this!=null&&!isNaN(this)&&this.trim()!="")};String.prototype.isBoolean=function(){return(this!=null&&("true"==this.trim()||"false"==this.trim()))};String.prototype.contains=function(w){return(this.match(w)==w)};function o(){var w={xmlDoc:null,parser:null,parseFromString:function(x){if(a.DOMParser){parser=new DOMParser();xmlDoc=parser.parseFromString(x,"text/xml")}else{xmlDoc=new ActiveXObject("Microsoft.XMLDOM");xmlDoc.async="false";xmlDoc.loadXML(x)}if(xmlDoc==null){console.log("xml "+xmlDoc+" not found!")}},getFirstElementByTagName:function(x){return xmlDoc?xmlDoc.getElementsByTagName(x)[0]:null},getAllTagElements:function(){return xmlDoc?xmlDoc.getElementsByTagName("*"):null},getStringAttribute:function(y,A,z){var x=y.getAttribute(A);return x?x.trim().toLowerCase():z},getIntAttribute:function(y,A,z){var x=this.getStringAttribute(y,A,z);return x?parseInt(x):z},getFloatAttribute:function(y,A,z){var x=this.getStringAttribute(y,A,z);return x?parseFloat(x):z},getBooleanAttribute:function(y,A,z){var x=this.getStringAttribute(y,A,z);return x?(x=="true"):z},free:function(){xmlDoc=null;parser=null}};return w}function i(){if(q){return}var w=l.createElement("audio");me.utils.setNocache(l.location.href.match(/\?nocache/));if(w.canPlayType){me.audio.capabilities.mp3=("no"!=w.canPlayType("audio/mpeg"))&&(""!=w.canPlayType("audio/mpeg"));me.audio.capabilities.ogg=("no"!=w.canPlayType('audio/ogg; codecs="vorbis"'))&&(""!=w.canPlayType('audio/ogg; codecs="vorbis"'));me.audio.capabilities.wav=("no"!=w.canPlayType('audio/wav; codecs="1"'))&&(""!=w.canPlayType('audio/wav; codecs="1"'));me.sys.sound=me.audio.capabilities.mp3||me.audio.capabilities.ogg||me.audio.capabilities.wav}if((me.sys.ua.search("iphone")>-1)||(me.sys.ua.search("ipod")>-1)||(me.sys.ua.search("ipad")>-1)||(me.sys.ua.search("android")>-1)){me.sys.sound=false}me.timer.init();me.XMLParser=new o();me.loadingScreen=new me.DefaultLoadingScreen();me.state.init();me.entityPool.init();me.levelDirector.reset();q=true}var d=Object.extend({pos:null,scale:null,lastflipX:false,lastflipY:false,z:0,currentSpriteOff:0,spriteWidth:0,spriteHeight:0,displayWidth:0,displayHeight:0,scaleFlag:false,autodestroy:true,visible:true,image:null,collisionBox:null,vp:null,init:function(w,A,z){this.pos=new me.Vector2d(w,A);this.scale=new me.Vector2d(1,1);if(z!=b){this.image=z;this.displayWidth=this.spriteWidth=this.image.width;this.displayHeight=this.spriteHeight=this.image.height}this.collisionBox=new me.Rect(this.pos,this.displayWidth,this.displayHeight);this.vp=me.game.viewport},flipX:function(w){if(w!=this.lastflipX){this.lastflipX=w;this.scale.x=-this.scale.x;this.scaleFlag=((this.scale.x!=1)||(this.scale.y!=1));this.collisionBox.flipX(this.spriteWidth)}},flipY:function(w){if(w!=this.lastflipY){this.lastflipY=w;this.scale.y=-this.scale.y;this.scaleFlag=((this.scale.x!=1)||(this.scale.y!=1));this.collisionBox.flipY(this.spriteHeight)}},update:function(){return false},draw:function(x){var w=this.pos.x-this.vp.pos.x,y=this.pos.y-this.vp.pos.y;if(this.scaleFlag){x.scale(this.scale.x,this.scale.y);w=(w*this.scale.x)-(this.scale.x<0?this.spriteWidth:0);y=(y*this.scale.y)-(this.scale.y<0?this.spriteHeight:0)}x.drawImage(this.image,this.currentSpriteOff,0,this.spriteWidth,this.spriteHeight,~~w,~~y,this.displayWidth,this.displayHeight);if(this.scaleFlag){x.setTransform(1,0,0,1,0,0)}if(me.debug.renderHitBox){this.collisionBox.draw(x)}},destroy:function(){this.onDestroyEvent();if(this.autodestroy){this.image=null;me.game.remove(this)}},onDestroyEvent:function(){},});a.me.SpriteObject=d;var s=d.extend({type:0,currentSprite:0,collidable:false,fpscount:0,init:function(w,B,A,z){this.parent(w,B,A);this.animationspeed=me.sys.fps/10;if(this.image!=b){this.displayWidth=this.spriteWidth=z||this.image.width;this.spritecount=~~(this.image.width/this.spriteWidth)}else{this.spritecount=1}this.collisionBox.set(this.pos,this.displayWidth,this.displayHeight);this.currentSpriteOff=0},setCurrentSprite:function(w){this.currentSprite=w;this.currentSpriteOff=this.spriteWidth*w},updateColRect:function(z,A,C,B){this.collisionBox.adjustSize(z,A,C,B)},update:function(){if(this.visible&&(this.fpscount++>this.animationspeed)){this.setCurrentSprite(++thiscurrentSprite%this.spritecount);this.fpscount=0;return true}return false},checkCollision:function(x){var w=this.collisionBox.collideVsAABB(x.collisionBox);if(w.x!=0||w.y!=0){this.onCollision(w,x);w.type=this.type;return w}return null},onCollision:function(w){if(this.collidable&&(this.type==me.game.COLLECTABLE_OBJECT)){this.destroy()}}});a.me.AnimatedSpriteObject=s;var e=(function(){var D={};var H=0;var E=0;var G=null;var C=[];var w=0;var F=false;var B=true;var A=false;var z=[];D.viewport=null;D.HUD=null;D.collisionMap=null;D.currentLevel=null;D.NO_OBJECT=0;D.ENEMY_OBJECT=1;D.COLLECTABLE_OBJECT=2;D.ACTION_OBJECT=3;D.init=function(J,L,K,I){if(!A){J=J||0;L=L||0;var K=K||me.video.getWidth();var I=I||me.video.getHeight();spriteCanvasSurface=me.video.createCanvasSurface(K,I);D.viewport=new me.Viewport(0,0,K,I);G=me.video.getScreenFrameBuffer();A=true}};D.reset=function(){if(!A){D.init()}D.removeAll();if(D.viewport){D.viewport.reset()}B=true};D.loadTMXLevel=function(J){D.currentLevel=J;D.collisionMap=D.currentLevel.getLayerByName("collision");if(!D.collisionMap||!D.collisionMap.isCollisionMap){alert("WARNING : no collision map detected")}D.currentLevel.addTo(me.game);D.viewport.setBounds(D.currentLevel.realwidth,D.currentLevel.realheight);var x=D.currentLevel.getObjectGroups();for(var I=0;I<x.length;I++){for(var y=0;y<x[I].objects.length;y++){D.addEntity(x[I].objects[y],x[I].z)}}D.sort()};D.addEntity=function(x,y){D.add(me.entityPool.newIstanceOf(x),y)};D.addHUD=function(I,M,J,L,K){if(D.HUD==null){D.HUD=new me.HUD_Object(I,M,J,L,K)}};D.disableHUD=function(){if(D.HUD!=null){D.HUD=null}};D.add=function(x,y){x.z=(y)?y:x.z;C.push(x);if(x.mouseEvent){z.push(x)}w=C.length};D.mouseEvent=function(I,K){for(var J=z.length;J--;){z[J].mouseEvent(I,K)}};D.update=function(){me.timer.update();for(var x=w,y;x--,y=C[x];){if(y.update()){B=true}if(y.isEntity&&!y.flickering){y.visible=D.viewport.isVisible(y.collisionBox)}}B=D.viewport.update(B)};D.remove=function(x){C.splice(C.indexOf(x),1);if(x.mouseEvent){z.splice(z.indexOf(x),1)}w=C.length;B=true};D.removeAll=function(){w=0;C=[];z=[];B=true};D.sort=function(){C.sort(function(y,x){return(x.z-y.z)});B=true};D.collide=function(y){var x=null;for(var I=w,J;I--,J=C[I];){if(J.visible&&J.collidable&&J.isEntity){if(x=J.checkCollision(y)){break}}}return x};D.repaint=function(){B=true};D.draw=function(){if(B){for(var x=w,y;x--,y=C[x];){if(y.visible){y.draw(spriteCanvasSurface,H,E)}}if(D.HUD!=null){D.HUD.draw(spriteCanvasSurface,H,E)}D.viewport.draw(spriteCanvasSurface);G.drawImage(spriteCanvasSurface.canvas,H,E);B=false}};return D})();var u=Object.extend({visible:true,actionKey:null,init:function(w){this.nextState=w||null;this.actionKey=me.input.KEY.ENTER},reset:function(w){me.game.reset();me.game.add(this,999);this.onResetEvent(w);me.game.sort();if(this.actionKey){me.input.bindKey(this.actionKey,"enter")}},destroy:function(){if(this.actionKey){me.input.unbindKey(this.actionKey,"enter")}this.onDestroyEvent()},update:function(){if(this.actionKey&&me.input.isKeyPressed("enter")){me.state.change(this.nextState)}return true},onUpdateFrame:function(){me.game.update();me.game.draw();me.video.blitSurface()},draw:function(w){},onResetEvent:function(){},onDestroyEvent:function(){}});a.me.ScreenObject=u;window.requestAnimFrame=(function(){return window.requestAnimationFrame||window.webkitRequestAnimationFrame||window.mozRequestAnimationFrame||window.oRequestAnimationFrame||window.msRequestAnimationFrame||function(x,w){return window.setTimeout(x,~~(1000/me.sys.fps))}})();var k=(function(){var B={};var x=-1;var w=-1;var y=[null,null,null,null,null,null,null,null,null,null,null,];function C(){if(w==-1){me.timer.reset();if(me.sys.useNativeAnimFrame){w=window.requestAnimFrame(z)}else{w=setInterval(function(){y[x].onUpdateFrame()},~~(1000/me.sys.fps))}}}function z(){y[x].onUpdateFrame();if(w!=-1){w=window.requestAnimFrame(z)}}function A(){if(w!=-1){if(me.sys.useNativeAnimFrame){clearTimeout(w)}else{clearInterval(w)}w=-1}}B.LOADING=0;B.MENU=1;B.READY=2;B.PLAY=3;B.GAMEOVER=4;B.GAME_END=5;B.SCORE=6;B.CREDITS=7;B.SETTINGS=8;B.init=function(){B.set(B.LOADING,me.loadingScreen);a.addEventListener("blur",function(){if(x!=B.LOADING){B.pause(true)}},false);a.addEventListener("focus",function(){if(x!=B.LOADING){B.resume(true)}},false)};B.pause=function(D){A();if(D){me.audio.pauseTrack()}};B.resume=function(D){C(x);if(D){me.audio.resumeTrack()}};B.set=function(D,E){y[D]=E};B.change=function(D){switch(D){case B.LOADING:case B.MENU:case B.PLAY:case B.READY:case B.GAMEOVER:case B.GAME_END:case B.SCORE:case B.CREDITS:case B.SETTINGS:A();if(y[x]){y[x].destroy()}y[D].reset(arguments[1]);x=D;C();break;default:break}};B.isCurrent=function(D){return x==D};return B})();a.me.state=k;a.me.game=e})(window);(function(d,e){var b=me.ScreenObject.extend({init:function(){this.parent();this.loadingLogo=null,this.font=new me.Font("Courier",14,"white","top");this.font.bold();this._loadingLogo=new Image();this._loadingLogo.src=me.melonJSLogo},setLoadingLogo:function(f){this._loadingLogo=new Image();this._loadingLogo.src=f},onResetEvent:function(){this.actionKey=null},onDestroyEvent:function(){if(this._loadingLogo){this._loadingLogo=null}},draw:function(f){var i=f.canvas.height/2;me.video.clearSurface(f,"black");if(this._loadingLogo){f.drawImage(this._loadingLogo,(f.canvas.width-this._loadingLogo.width)/2,(f.canvas.height-this._loadingLogo.height)/2);i+=this._loadingLogo.height/2+20}var g=Math.floor(me.loader.getLoadProgress()*f.canvas.width);f.strokeStyle="silver";f.strokeRect(0,i,f.canvas.width,20);f.fillStyle="gray";f.fillRect(2,i+2,g-4,16);var h=this.font.measureText(f,"Loading...");this.font.draw(f,"Loading...",((f.canvas.width-h.width)/2),i+14)},});var a=(function(){var l={};var h=[];var f=[];var o=0;var j=0;var k=0;function i(){if(j==o){for(var s in f){if(f[s].isTMX){me.levelDirector.addTMXLevel(s)}}if(l.onload){k=setTimeout(l.onload,500)}else{alert("no load callback defined")}}else{k=setTimeout(i,100)}}function m(s){console.log("Failing loading image")}function q(s){h.push(s.name);h[s.name]=new Image();h[s.name].onload=l.onRessourceLoaded.bind(l);h[s.name].onerror=m.bind(this);h[s.name].src=s.src+me.nocache}function g(t,s){if(d.XMLHttpRequest){xmlhttp=new XMLHttpRequest();if(xmlhttp.overrideMimeType){xmlhttp.overrideMimeType("text/xml")}}else{xmlhttp=new ActiveXObject("Microsoft.XMLHTTP")}xmlhttp.open("GET",t.src+me.nocache,false);xmlhttp.onload=l.onRessourceLoaded.bind(l);xmlhttp.send();f[t.name]={};f[t.name].xml=xmlhttp.responseText;f[t.name].isTMX=s||false}l.onload=e;l.onRessourceLoaded=function(s){j++};l.preload=function(t){me.audio.setLoadCallback(l.onRessourceLoaded.bind(l));for(var s=0;s<t.length;s++){switch(t[s].type){case"image":q(t[s]);o+=1;break;case"audio":if(me.audio.isAudioEnable()){me.audio.load(t[s]);o+=1}break;case"tmx":g(t[s],true);o+=1;break;default:alert("error : unknow ressource type : %s",t[s].type);break}}i()};l.getXML=function(s){if(f!=null){return f[s].xml}else{return null}};l.getImage=function(s){if(h!=null){return h[s]}else{return null}};l.getLoadProgress=function(){return j/o};return l})();d.me.loader=a;d.me.DefaultLoadingScreen=b})(window);(function(b,d){var a="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAJAAAAAgCAMAAADKUgH/AAAAGXRFWHRTb2Z0d2FyZQBBZG9iZSBJbWFnZVJlYWR5ccllPAAAAMBQTFRFhdQFZZozZqIwg6xZ4+zZN2ILZrMrWIooZqsuVI8JQnIEeaZNKlMEmucwmvEQg8JNe8YTYZobbK0FeLQ3d7FKBSABfL89hcgkersmqfkxl9VLkt4otftS3/+Wbp9AYJ8EjdQfdrkVcKo7T34ma7MEdL4GbKQ+baYWkdtAlN41gcQ4H0QEic5Fs8yZ2ebN9vnzxtmznL177PPm0N/AqcaNvNOmcqhKmt5Nx/pmovsEcK4s///TjLNmZrwp////ZpkzU1rSTAAAAEB0Uk5T////////////////////////////////////////////////////////////////////////////////////AMJ7sUQAAAOOSURBVHjazJhtW7IwFMcdCizAB1QeigLE1FRAyYe6C+H7f6t7A4YDMaW6Lvu/EDbY2Y+z7ZzNRvzH1Lg5AWAYcFMgBiZi0gJ3SMRB8AtAoed5Yu1WBIHCScT8HMiLoij8ARA4FMTcHAgWgQ43B+IOFS66JVDGAcEfA2JIFfxVILRsddue69cDMReBwjBsknsTFU6WdLNYWQB6MAxXVbsLrVduVTKVA4GzQDvf38XmeoXsR68Brg1a+D5q0QMipi9EK8+sAOrZi4HqPry5A9WepFWB7/v4NzrarRwyDsXqRIAAoSb+Nu0NKYhFPzoWaHdkWjVPgGRVfXt8vL+//9dxh24vf1xh6gQoj4kxBURpdWRDBeKNdfKZ6JuTWrEEZKnu0+fT48vcmHc67e5wQh5TpqLm+TjEgQqglheG2VBFq802DBOfbNPXthgn6dzEaH4RaKDO3z+fXHWodruu0ekYKsx9uloHyBQGW38VqZkyUDbG5is24qceCPOuTWSwRZy1IV+bA8GX+/euY4r7/X6433dfOm1nCFKgddqqidFOchkdqkl2zYDy3naopUdoMV3uoHwBiuSVDAjs220HTKeO3tM/HNOcOt15mwHFRYhdL5aBCkTZsJFJTRoGtJUNAULmNsd5R0oEaGE4jq73bLuBpA2cKRgao3HyuCJE0EB5LDrWlIFCGig3iX0f5mpl72edyM8jDaMYtqbZtjFvaNoA9PmrgGLAVeSyi0DNqCwayOr3J8gzi8FA13RdQ1SNyUwWikDBGSDaSfBqoPBLIJnnefDxsZ+i2TNFU8lhZCSpCBRWAJF4yNFjdjVQy6e1o4B4mR+PxzxvJgI8Lo3Hy8tA5dRxqAXknU2uktyXU4hEKR0r1QCCdYFMdN2dz/asIM/wKPG8nF3uBKmOh5i6QDGKi6/ngRSBvUMzuz8aPT/rk1HfsiRpaV4G4r4PtK50EYlDiiSwrHBnybPZzLIs5B52qYBqIAAPp0C1hyxdZse9iOl5hdiiSCxGEoSxgK6sxLIK3ZqyC+kwSAqw9ipLYzbJSyJKlUWgWME0LJEgKPFFIFgM0/XiEPJJug3wPW+T3JWAkI+kDAlflPgyEBOfHDuYGkCxWdw0lYFiZSlJGAZJUuLLQFw5k9EHxWuA8m1tusWpOHUspSWCQuursnUJCGaZjJpT3zhKiwE6zHvbsycfBav2fx+Q4zjy3wPSfwEGALse50AvngzqAAAAAElFTkSuQmCC";b.me.melonJSLogo=a})(window);(function(d,e){function b(f,g){this.x=f||0;this.y=g||0}b.prototype.set=function(f,g){this.x=f;this.y=g};b.prototype.setZero=function(){this.set(0,0)};b.prototype.setV=function(f){this.x=f.x;this.y=f.y};b.prototype.add=function(f){this.x+=f.x;this.y+=f.y};b.prototype.sub=function(f){this.x-=f.x;this.y-=f.y};b.prototype.scale=function(f){this.x*=f.x;this.y*=f.y};b.prototype.negate=function(){return new b(-this.x,-this.y)};b.prototype.div=function(f){this.x/=f;this.y/=f};b.prototype.copy=function(f){this.x=f.x;this.y=f.y};b.prototype.length=function(){return Math.sqrt(this.x*this.x+this.y*this.y)};b.prototype.normalize=function(){var f=this.length();this.x/=f;this.y/=f};b.prototype.dotProduct=function(f){return this.x*f.x+this.y*f.y};b.prototype.distance=function(f){return Math.sqrt((this.x-f.x)*(this.x-f.x)+(this.y-f.y)*(this.y-f.y))};b.prototype.clone=function(){return new b(this.x,this.y)};b.prototype.toString=function(){return"x:"+this.x+"y:"+this.y};var a=Object.extend({pos:null,colPos:null,width:0,height:0,fWidth:0,fHeight:0,hWidth:0,hHeight:0,tthis:null,trect:null,init:function(g,f,i){this.pos=g;this.colPos=new b();this.width=f;this.height=i;this.fWidth=f;this.fHeight=i;this.hWidth=~~(f/2);this.hHeight=~~(i/2);this.tthis=new b();this.trect=new b();this.__defineGetter__("left",function(){return this.pos.x+this.colsPos.x});this.__defineGetter__("right",function(){return this.pos.x+this.colsPos.x+this.width});this.__defineGetter__("top",function(){return this.pos.y+this.colPos.y});this.__defineGetter__("bottom",function(){return this.pos.y+this.colPos.y+this.height})},set:function(g,f,i){this.pos=g;this.width=f;this.height=i;this.fWidth=f;this.fHeight=i;this.hWidth=~~(f/2);this.hHeight=~~(i/2)},adjustSize:function(f,g,j,i){if(f!=-1){this.colPos.x=f;this.width=g;this.hWidth=~~(this.width/2)}if(j!=-1){this.colPos.y=j;this.height=i;this.hHeight=~~(this.height/2)}},flipX:function(f){this.colPos.x=f-this.width-this.colPos.x;this.hWidth=~~(this.width/2)},flipY:function(f){this.colPos.y=f-this.height-this.colPos.y;this.hHeight=~~(this.height/2)},checkAxisAligned:function(f){this.tthis.x=this.pos.x+this.colPos.x;this.tthis.y=this.pos.y+this.colPos.y;this.trect.x=f.pos.x+f.colPos.x;this.trect.y=f.pos.y+f.colPos.y;return(this.tthis.x<this.trect.x+f.width&&this.trect.x<this.tthis.x+this.width&&this.tthis.y<this.trect.y+f.height&&this.trect.y<this.tthis.y+this.height)},collideVsAABB:function(h){p=new b(0,0);if(this.checkAxisAligned(h)){var g=this.tthis.x+this.hWidth-this.trect.x-h.hWidth;var f=this.tthis.y+this.hHeight-this.trect.y-h.hHeight;p.x=(h.hWidth+this.hWidth)-(g<0?-g:g);p.y=(h.hHeight+this.hHeight)-(f<0?-f:f);if(p.x<p.y){p.y=0;p.x=g<0?-p.x:p.x}else{p.x=0;p.y=f<0?-p.y:p.y}}return p},draw:function(f){f.strokeStyle="red";f.strokeRect(this.pos.x+this.colPos.x-me.game.viewport.pos.x,this.pos.y+this.colPos.y-me.game.viewport.pos.y,this.width,this.height)}});d.me.Vector2d=b;d.me.Rect=a})(window);(function(a,b){var d=Object.extend({ALIGN:{LEFT:"left",CENTER:"center",RIGHT:"right"},font:null,height:null,color:null,align:null,init:function(f,g,e,h){this.set(f,g,e,h)},bold:function(){this.font="bold "+this.font},italic:function(){this.font="italic "+this.font},set:function(f,g,e,h){this.font=""+g+"px "+f;this.height=g;this.color=e;this.align=h||"top"},measureText:function(e,f){e.font=this.font;e.fillStyle=this.color;e.textBaseLine=this.align;dim=e.measureText(f);dim.height=this.height;return dim},draw:function(f,g,e,h){f.font=this.font;f.fillStyle=this.color;f.textBaseLine=this.align;f.fillText(g,~~e,~~h)}});BitmapFont=d.extend({size:null,sSize:null,scale:1,firstChar:32,init:function(e,f,h,g){this.parent(e,null,null);this.size=new me.Vector2d(f,0);this.sSize=new me.Vector2d();this.scale=h||1;this.firstChar=g||32;this.loadFontMetrics(e);this.align=this.ALIGN.RIGHT},loadFontMetrics:function(e){this.font=me.loader.getImage(e);this.size.y=this.font.height||0;this.sSize.copy(this.size);this.sSize.x*=this.scale;this.sSize.y*=this.scale},set:function(f,e){this.align=f;if(e){this.sSize.copy(this.size);this.sSize.x*=this.scale;this.sSize.y*=this.scale}},measureText:function(e){return{width:e.length*this.sSize.x,height:this.sSize.y}},draw:function(g,h,e,j){if(typeof(h)!="string"){h=h.toString()}if(this.align==this.ALIGN.RIGHT){e-=h.length*this.sSize.x}for(var f=0;f<h.length;f++){g.drawImage(this.font,(h.charCodeAt(f)-this.firstChar)*this.size.x,0,this.sSize.x,this.sSize.y,~~e,~~j,this.size.x,this.size.y);e+=this.sSize.x}}});a.me.Font=d;a.me.BitmapFont=BitmapFont})(window);(function(b,d){var a=me.AnimatedSpriteObject.extend({isClickable:true,updated:false,init:function(e,h,g,f){this.parent(this,e,h,g,f)},update:function(){if(this.updated){this.updated=false;return true}return false},clicked:function(){return false},mouseEvent:function(e,f){if((e>this.pos.x)&&(e<this.pos.x+this.displayWidth)&&(f>this.pos.y)&&(f<this.pos.y+this.displayHeight)){if(this.isClickable){this.updated=this.clicked()}}return this.updated}});b.me.GUI_Object=a})(window);(function(d,e){var b=Object.extend({init:function(f,h,g){this.pos=new me.Vector2d(f||0,h||0);this.visible=true;this.defaultvalue=g||0;this.value=g||0;this.updated=true},reset:function(){this.value=this.defaultvalue;this.updated=true},update:function(f){this.value+=f;this.updated=true;return this.updated},draw:function(g,f,h){if(this.updated){this.updated=false}}});function a(f,k,g,j,i){this.pos=new me.Vector2d(f||0,k||0);this.width=g||me.video.getWidth();this.height=j||me.video.getHeight();this.bgcolor=i;this.HUDItems={};this.HUDobj=[];this.visible=true;this.HUD_invalidated=true;HUDCanvasSurface=me.video.createCanvasSurface(this.width,this.height);this.z=999;this.objCount=0}a.prototype.addItem=function(f,g){this.HUDItems[f]=g;this.HUDobj.push(this.HUDItems[f]);this.objCount++;this.HUD_invalidated=true};a.prototype.updateItemValue=function(f,g){if(this.HUDItems[f]&&(this.HUDItems[f].update(g)==true)){this.HUD_invalidated=true}};a.prototype.getItemValue=function(f){return(this.HUDItems[f])?this.HUDItems[f].value:0};a.prototype.update=function(){return this.HUD_invalidated};a.prototype.reset=function(f){if(this.HUDItems[f]){this.HUDItems[f].reset()}this.HUD_invalidated=true};a.prototype.resetAll=function(){for(var f=this.objCount,g;f--,g=this.HUDobj[f];){g.reset()}this.HUD_invalidated=true};a.prototype.draw=function(h,f,k){if(this.HUD_invalidated){if(this.bgcolor){me.video.clearSurface(HUDCanvasSurface,this.bgcolor)}else{HUDCanvasSurface.canvas.width=HUDCanvasSurface.canvas.width}for(var g=this.objCount,j;g--,j=this.HUDobj[g];){if(j.visible){j.draw(HUDCanvasSurface,f,k)}}}h.drawImage(HUDCanvasSurface.canvas,this.pos.x,this.pos.y);this.HUD_invalidated=false};d.me.HUD_Item=b;d.me.HUD_Object=a})(window);(function(b,d){var a=(function(){var l={};var v=[];var e=["mp3","ogg","wav"];var i=null;var u=-1;var g=null;var o=null;var m=true;var t=0;function j(){var w=0;if(!me.sys.sound){m=false;return}if((i.search(/mp3/i)!=-1)&&l.capabilities.mp3){return e[w]}if((i.search(/ogg/i)!=-1)&&l.capabilities.ogg){return e[++w]}if((i.search(/wav/i)!=-1)&&l.capabilities.wav){return e[++w]}m=false;return -1}function h(x){var w=v[x];for(var y=0,z;z=w[y++];){if(z.ended||!z.currentTime){z.currentTime=t;return z}}w[0].pause();w[0].currentTime=t;return w[0]}function q(w){v[w][0].load()}function f(w,y){if(y>1){var x=v[w][0];for(channel=1;channel<y;channel++){v[w][channel]=x.cloneNode(true);v[w][channel].load()}}if(g){g()}}function s(x,w,z){var y=h(x);y.loop=w||false;y.play();if(z&&!w){y.addEventListener("ended",function(A){y.removeEventListener("ended",arguments.callee,false);z()},false)}}function k(x,w,y){if(y&&!w){setTimeout(y,2000)}}l.capabilities={mp3:false,ogg:false,ma4:false,wav:false,};l.init=function(w){if(w){i=new String(w)}else{i=new String("mp3")}u=j();if(m){l.play=s}else{l.play=k}return m};l.setLoadCallback=function(w){g=w};l.isAudioEnable=function(){return m};l.enable=function(){m=me.sys.sound;if(m){l.play=s}else{l.play=k}};l.disable=function(){m=false;l.play=k};l.load=function(x){if(u==-1){return 0}var w=new Audio(x.src+x.name+"."+u+me.nocache);w.preload="auto";w.addEventListener("canplaythrough",function(y){this.removeEventListener("canplaythrough",arguments.callee,false);f(x.name,x.channel)},false);w.addEventListener("error",function(y){q(x.name)},false);w.src=x.src+x.name+"."+u+me.nocache;w.load();v[x.name]=[w];return 1};l.stop=function(w){if(m){var x=v[w];for(channel_id=x.length;channel_id--;){x[channel_id].pause();x[channel_id].currentTime=t}}};l.pause=function(w){if(m){var x=v[w];for(channel_id=x.length;channel_id--;){x[channel_id].pause()}}};l.playTrack=function(w){if(m){if(o!=null){l.stopTrack()}o=h(w);if(o){o.loop=true;o.play()}}};l.stopTrack=function(){if(m&&o){o.pause();o=null}};l.pauseTrack=function(){if(m&&o){o.pause()}};l.resumeTrack=function(){if(m&&o){o.play()}};return l})();b.me.audio=a})(window);(function(d,e){var a=(function(){var j={};var s=null;var f=false;var k=0;var l=0;var h=0;var q=0;var g=0;var o=0;var i=Math.ceil(1000/me.sys.fps);var t=(1000/me.sys.fps)*1.25;function m(){s.replaceChild(document.createTextNode("("+h+"/"+me.sys.fps+" fps)"),s.firstChild)}j.tick=1;j.init=function(){s=document.getElementById("framecounter");f=(s!==null);j.reset()};j.reset=function(){g=q=new Date().getTime();l=0;k=0};j.getTime=function(){return g};j.update=function(){q=g;g=new Date().getTime();o=(g-q);if(f){k++;l+=o;if(k%10==0){h=Math.ceil((1000*k)/l);m();l=0;k=0}}j.tick=(o>t&&me.sys.interpolation)?o/i:1};return j})();var b=(function(){var i={};var h=null;var l=null;var m=null;var k=null;var g=null;var o=false;var j=0;var f=0;i.init=function(t,v,s,q,u){o=q;me.sys.scale=o===true?u:1;j=v*me.sys.scale;f=s*me.sys.scale;g=document.getElementById(t);h=document.createElement("canvas");h.setAttribute("width",(j)+"px");h.setAttribute("height",(f)+"px");h.setAttribute("border","0px solid black");g.appendChild(h);if(h.getContext){l=h.getContext("2d");if(o){k=i.createCanvasSurface(v,s);m=k.canvas}else{k=l;m=l.canvas}}else{return false}return true};i.getWrapper=function(){return g};i.getWidth=function(){return m.width};i.getHeight=function(){return m.height};i.createCanvasSurface=function(s,q){var t=document.createElement("canvas");t.width=s||m.width;t.height=q||m.height;return t.getContext("2d")};i.getScreenCanvas=function(){return h};i.getScreenFrameBuffer=function(){return k};i.updateDisplaySize=function(q){if(o){if(q){me.sys.scale=q}else{me.sys.scale=document.getElementById("screen size").value}j=m.width*me.sys.scale;f=m.height*me.sys.scale;h.width=j;h.height=f}};i.clearSurface=function(s,q){s.fillStyle=q;s.fillRect(0,0,s.canvas.width,s.canvas.height)};i.scale=function(q,s){q.translate(-(((q.canvas.width*s)-q.canvas.width)>>1),-(((q.canvas.height*s)-q.canvas.height)>>1));q.scale(s,s)};i.setAlpha=function(s,q){s.globalCompositeOperation=q?"source-over":"copy"};i.blitSurface=function(){if(o){i.blitSurface=function(){l.drawImage(m,0,0,m.width,m.height,0,0,j,f)}}else{i.blitSurface=function(){}}i.blitSurface()};i.applyEffect=function(z,u){var v=i.createCanvasSurface();var w=k.getImageData(0,0,m.width,m.height);var x=w.data;switch(z){case"b&w":for(var t=0,s=x.length;t<s;t+=4){var q=(3*x[t]+4*x[t+1]+x[t+2])>>>3;x[t]=q;x[t+1]=q;x[t+2]=q}break;case"brightness":var y=Math.abs(u);y=(y>1)?1:y;for(var t=0,s=x.length;t<s;t+=4){x[t]*=y;x[t+1]*=y;x[t+2]*=y}break;default:return null}v.putImageData(w,0,0);return v};return i})();d.me.timer=a;d.me.video=b})(window);(function(b,d){var a=(function(){var j={};var h=[];var m=[];var s=[];var f=[];var i=null;var l=null;var q=false;function t(v){if(v){if(!q){b.addEventListener("keydown",g,false);b.addEventListener("keyup",e,false)}}else{b.removeEventListener("keydown",g,false);b.removeEventListener("keyup",e,false)}q=v}function o(v){v.stopPropagation();if(v.preventDefault){v.preventDefault()}v.returnValue=false}function g(w){var v=h[w.keyCode||w.which];if(v){if(!f[v]){m[v]=true;f[v]=s[v]}o(w);return false}return true}function e(w){var v=h[w.keyCode||w.which];if(v){m[v]=false;f[v]=false;o(w);return false}return true}function k(w){var v=w.clientX-me.video.getScreenCanvas().offsetLeft;var z=w.clientY-me.video.getScreenCanvas().offsetTop;i(v,z)}function u(v){}j.KEY={LEFT:37,UP:38,RIGHT:39,DOWN:40,ENTER:13,SHIFT:16,CTRL:17,ALT:18,PAUSE:19,ESC:27,SPACE:32,"0":48,"1":49,"2":50,"3":51,"4":52,"5":53,"6":54,"7":55,"8":56,"9":57,A:65,B:66,C:67,D:68,E:69,F:70,G:71,H:72,I:73,J:74,K:75,L:76,M:77,N:78,O:79,P:80,Q:81,R:82,S:83,T:84,U:85,V:86,W:87,X:88,Y:89,Z:90,};j.isKeyPressed=function(v){if(m[v]){if(s[v]){f[v]=true;m[v]=false}return true}return false};j.keyStatus=function(v){return(f[v]===true)?true:m[v]};j.bindKey=function(v,x,w){if(!q){t(true)}h[v]=x;s[x]=w?w:false;f[x]=false};j.unbindKey=function(v){m[h[v]]=false;s[h[v]]=false;h[v]=null};j.enableMouseEvent=function(v,w){if(v){me.video.getScreenCanvas().addEventListener("click",k,false);i=w}else{me.video.getScreenCanvas().removeEventListener("click",k,false)}};j.enableGyroscopicEvent=function(v,w){if(b.sys.gyro){b.ondevicemotion=v?u:null;l=v?w:null}};return j})();b.me.input=a})(window);(function(b,d){var a=(function(){var g={};var f="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split("");var h=null;function e(){if(h==null){h={};for(var j=0;j<f.length;j++){h[f[j]]=j}}}g.decodeNumBase64=function(i){e();i=i.replace(new RegExp("[^"+f.join("")+"=]","g"),"");p=(i.charAt(i.length-1)=="="?(i.charAt(i.length-2)=="="?"AA":"A"):"");r=[];i=i.substr(0,i.length-p.length)+p;for(c=0;c<i.length;c+=4){n=(h[i.charAt(c)]<<18)+(h[i.charAt(c+1)]<<12)+(h[i.charAt(c+2)]<<6)+h[i.charAt(c+3)];r.push((n>>>16)&255);r.push((n>>>8)&255);r.push(n&255)}return r};g.setNocache=function(i){me.nocache=i?"?"+parseInt(Math.random()*10000000):""};g.random=function(j,i){return(~~(Math.random()*(i-j+1))+j)};g.round=function(i,k){var j=Math.pow(10,k);return(Math.round(i*j)/j)};g.HexToRGB=function(j,i){j=(j.charAt(0)=="#")?j.substring(1,7):j;rgb=(i?"rgba(":"rgb(")+parseInt(j.substring(0,2),16);rgb+=","+parseInt(j.substring(2,4),16);rgb+=","+parseInt(j.substring(4,6),16)+(i?","+i+")":")");return rgb};return g})();b.me.utils=a})(window);(function(d,e){function b(f){this.defaultvalue=f||0;this.value=f||0;this.updated=true}b.prototype.reset=function(){this.value=this.defaultvalue;this.updated=true};b.prototype.update=function(f){this.value+=f;this.updated=true;return this.updated};var a=(function(){var h={};var g={};var i=[];var f=0;h.add=function(j,k){g[j]=new b(k);i.push(g[j]);f++};h.updateValue=function(j,k){if(g[j]){g[j].update(k)}};h.getItemValue=function(j){return(g[j])?g[j].value:0};h.reset=function(j){if(j!=e){if(g[j]){g[j].reset()}}else{h.resetAll()}};h.resetAll=function(){for(var j=f,k;j--,k=i[j];){k.reset()}};return h})();d.me.gamestat=a})(window);(function(d,f){var a=Math.min,e=Math.max;var b=me.Rect.extend({AXIS:null,limits:null,target:null,follow_axis:0,_shake:null,_fade:null,_flash:null,init:function(g,l,k,j,h,i){this.parent(new me.Vector2d(g,l),k-g,j-l);this.limits=new me.Vector2d(h||this.width,i||this.height);this.setDeadzone(this.width/6,this.height/3);this.target=null;this.AXIS={NONE:0,HORIZONTAL:1,VERTICAL:2,BOTH:3};this.follow_axis=this.AXIS.NONE;this._shake={intensity:0,duration:0,axis:this.AXIS.BOTH,onComplete:null};this._flash={color:0,alpha:0,duration:0,onComplete:null};this._fade={color:0,alpha:0,duration:0,onComplete:null}},_followH:function(g){if((g.x-this.pos.x)>(this.width-this.deadzone.x)){this.pos.x=a((~~g.x)-(this.width-this.deadzone.x),this.limits.x-this.width)}else{if((g.x-this.pos.x)<(this.deadzone.x)){this.pos.x=e((~~g.x)-this.deadzone.x,0)}}},_followV:function(g){if((g.y-this.pos.y)>(this.height-this.deadzone.y)){this.pos.y=a((~~g.y)-(this.height-this.deadzone.y),this.limits.y-this.height)}else{if((g.y-this.pos.y)<(this.deadzone.y)){this.pos.y=e((~~g.y)-this.deadzone.y,0)}}},reset:function(g,h){this.pos.x=g||0;this.pos.y=h||0;this.target=null;this.follow_axis=null},setDeadzone:function(g,i){this.deadzone=new me.Vector2d((this.width-g)/2,(this.height-i)/2-i*0.25)},setBounds:function(g,h){this.limits.set(g,h)},follow:function(h,g){this.target=h;this.follow_axis=g||this.AXIS.NONE},move:function(g,h){newx=this.pos.x+g;newy=this.pos.y+h;if((newx>=0)&&(newx<=this.limits.x-this.width)){this.pos.x=newx}if((newy>=0)&&(newy<=this.limits.y-this.height)){this.pos.y=newy}},update:function(i){if(this.target&&(i||(this._shake.duration>0))){switch(this.follow_axis){case this.AXIS.NONE:break;case this.AXIS.HORIZONTAL:this._followH(this.target);break;case this.AXIS.VERTICAL:this._followV(this.target);break;case this.AXIS.BOTH:this._followH(this.target);this._followV(this.target);break;default:break}}if(this._shake.duration>0){this._shake.duration-=me.timer.tick;if(this._shake.duration<0){if(this._shake.onComplete){this._shake.onComplete()}}else{if((this._shake.axis==this.AXIS.BOTH)||(this._shake.axis==this.AXIS.HORIZONTAL)){var h=(Math.random()*this._shake.intensity);if(this.pos.x+this.width+h<this.limits.x){this.pos.x+=~~h}else{this.pos.x-=~~h}}if((this._shake.axis==this.AXIS.BOTH)||(this._shake.axis==this.AXIS.VERTICAL)){var g=(Math.random()*this._shake.intensity);if(this.pos.y+this.height+g<this.limits.y){this.pos.y+=~~g}else{this.pos.y-=~~g}}i=true}}if(this._fade.alpha<1){this._fade.alpha+=me.timer.tick/this._fade.duration;if(this._fade.alpha>=1){this._fade.alpha=1;if(this._fade.onComplete){this._fade.onComplete()}}i=true}if(this._flash.alpha>0){this._flash.alpha-=me.timer.tick/this._flash.duration;if(this._flash.alpha<=0){this._flash.alpha=0;if(this._flash.onComplete){this._flash.onComplete()}}i=true}return i},shake:function(g,j,h,i){h=h||this.AXIS.BOTH;if(h==this.AXIS.BOTH){if(this.width==this.limits.x){h=this.AXIS.VERTICAL}else{if(this.height==this.limits.y){h=this.AXIS.HORIZONTAL}}}if((h==this.AXIS.HORIZONTAL)&&(this.width==this.limits.x)){return}if((h==this.AXIS.VERTICAL)&&(this.height==this.limits.y)){return}this._shake.intensity=g;this._shake.duration=j;this._shake.axis=h;this._shake.onComplete=i||null},flash:function(g,i,h){this._flash.color=g;this._flash.duration=i||30;this._flash.alpha=1;this._flash.onComplete=h||null},fade:function(g,i,h){this._fade.color=g;this._fade.duration=i||30;this._fade.alpha=0;this._fade.onComplete=h||null},getWidth:function(){return this.width},getHeight:function(){return this.height},focusOn:function(g){this.pos.x=g.x-this.width*0.5;this.pos.y=g.y-this.height*0.5},isVisible:function(g){return this.checkAxisAligned(g)},draw:function(g){if(this._fade.alpha<1){me.video.clearSurface(g,me.utils.HexToRGB(this._fade.color,this._fade.alpha))}if(this._flash.alpha>0){me.video.clearSurface(g,me.utils.HexToRGB(this._flash.color,this._flash.alpha))}}});d.me.Viewport=b})(window);(function(g,b){var l=Math.min;var a=(function(){var o={};var m={};o.init=function(){m.levelentity=me.levelEntity};o.add=function(s,q){m[s.toLowerCase()]=q};o.newIstanceOf=function(q){if(!m[q.name]){alert("cannot instance entity of type '"+q.name+"': Class not found!");return null}return new m[q.name](q.x,q.y,q)};return o})();g.me.entityPool=a;function i(m,q,o){this.image=me.loader.getImage(m);this.spriteWidth=this.image.width;this.spriteHeight=this.image.height;this.baseOffset=0;this.z=o||0;this.scrollspeed=q;this.vp_width=me.game.viewport.width}i.prototype.draw=function(s,m,t){var q=0;var o=l(this.spriteWidth-m,this.vp_width);do{s.drawImage(this.image,m,0,o,this.spriteHeight,q,t,o,this.spriteHeight);q+=o;m=0;o=l(this.spriteWidth,this.vp_width-q)}while((q<this.vp_width))};function e(m){this.name="parallaxBackgroundEntity";this.visible=true;this.z=m||0;this.vp=me.game.viewport.pos;this.lastx=this.vp.x;this.parallaxEntities=[];this.parallaxEntitiesCount=0}e.prototype.addLayer=function(m,q,o){this.parallaxEntities.push(new i(m,q,o));this.parallaxEntitiesCount=0};e.prototype.clearTile=function(m,o){};e.prototype.update=function(){return false};e.prototype.draw=function(s,m,t){m=this.vp.x;if(m>this.lastx){for(var q=0,o;o=this.parallaxEntities[q++];){o.baseOffset=(o.baseOffset+o.scrollspeed*me.timer.tick)%o.spriteWidth;o.draw(s,~~o.baseOffset,t);this.lastx=m}return}else{if(m<this.lastx){for(var q=0,o;o=this.parallaxEntities[q++];){o.baseOffset=(o.spriteWidth+(o.baseOffset-o.scrollspeed*me.timer.tick))%o.spriteWidth;o.draw(s,~~o.baseOffset,t);this.lastx=m}return}}for(var q=0,o;o=this.parallaxEntities[q++];){o.draw(s,~~o.baseOffset,t);this.lastx=m}};g.me.ParallaxBackgroundEntity=e;var h=me.AnimatedSpriteObject.extend({init:function(m,s,q,o){this.anim=[];this.resetAnim=null;this.current=null;this.parent(m,s,q,o);if(this.image==b||(this.image.width==o)){this.update=function(){return false}}else{this.addAnimation("default",null);this.setCurrentAnimation("default")}},addAnimation:function(o,s){this.anim[o]={name:null,frame:[],idx:0,length:0};if(s==null){for(var q=0;q<this.spritecount;q++){this.anim[o].frame[q]=q*this.spriteWidth}}else{var m=0;for(var q=0;q<s.length;q++){this.anim[o].frame[m]=s[q]*this.spriteWidth;m++}}this.anim[o].name=o;this.anim[o].length=this.anim[o].frame.length},setCurrentAnimation:function(m,o){this.current=this.anim[m];this.resetAnim=o||null;this.currentSpriteOff=this.current.frame[this.current.idx]},isCurrentAnimation:function(m){return(this.current.name==m)},setCurrentSprite:function(m){this.current.idx=m;this.currentSpriteOff=this.current.frame[m]},update:function(){if(this.visible&&(this.fpscount++>this.animationspeed)){this.setCurrentSprite(++this.current.idx%this.current.length);if((this.current.idx==0)&&this.resetAnim){this.setCurrentAnimation(this.resetAnim)}this.fpscount=0;return true}return false}});var d=h.extend({init:function(m,s,q,o){this.parent(m,s,me.loader.getImage(q),o);this.pos.set(m,s+me.game.currentLevel.tileheight-this.spriteHeight);this.vel=new me.Vector2d();this.accel=new me.Vector2d();this.gravity=0.98;this.isEntity=true;this.canBreakTile=false;this.alive=true;this.falling=false;this.jumping=false;this.jumpspeed=0;this.slopeaddy=0;this.onslope=false;this.onladder=false;this.collidable=false;this.collectable=false;this.flickering=false;this.flickerTimer=-1;this.flickercb=null;this.collisionMap=me.game.collisionMap;this.onTileBreak=null},setVelocity:function(m,o){this.accel.x=(m!=0)?m:this.accel.x;this.accel.y=(m!=0)?o:this.accel.y},doWalk:function(m){this.flipX(m);this.vel.x=(m)?-this.accel.x*me.timer.tick:this.accel.x*me.timer.tick},doClimb:function(m){if(this.onladder){this.vel.y=(m)?-this.accel.x*me.timer.tick:this.accel.x*me.timer.tick;return true}return false},doJump:function(){if(!this.jumping&&!this.falling){this.jumpspeed=this.accel.y;this.jumping=true;if(this.onslope){this.pos.y+=this.slopeaddy}return true}return false},forceJump:function(){this.jumping=false;this.falling=false;this.doJump()},checkSlope:function(m){this.vel.y=(this.falling)?m.tile.pos.y-this.pos.y-this.displayHeight:0;this.slopeaddy=this.pos.x+this.collisionBox.colPos.x+this.vel.x+this.collisionBox.hWidth-m.tile.pos.x;if(m.yprop.isLeftSlope||m.xprop.isLeftSlope){this.slopeaddy=m.tile.height-this.slopeaddy;this.vel.y+=this.slopeaddy}else{if(m.yprop.isRightSlope||m.xprop.isRightSlope){this.vel.y+=this.slopeaddy}}},updateMovement:function(){if(this.jumping){this.jumpspeed-=this.gravity;if((this.jumpspeed<0)){this.jumping=false;this.falling=true;this.vel.y=0}else{this.vel.y=-this.jumpspeed}}else{if(!this.onladder){this.falling=true;this.vel.y+=this.gravity*me.timer.tick}}var m=this.collisionMap.checkCollision(this.collisionBox,this.vel);this.onladder=m.xprop.isLadder;this.onslope=m.yprop.isSlope||m.xprop.isSlope;if(m.y){if(this.vel.y>0){if(m.yprop.isSlope){if(this.falling){this.checkSlope(m);console.log("yslope");this.falling=false;this.jumping=false}}else{if(m.yprop.isSolid||m.yprop.isBreakable||(m.yprop.isPlatform&&(this.pos.y+this.displayHeight<=m.ytile.pos.y))){if(m.yprop.isBreakable&&this.canBreakTile){me.game.currentLevel.clearTile(m.ytile.row,m.ytile.col);if(this.onTileBreak){this.onTileBreak()}}else{this.vel.y=(this.falling)?m.ytile.pos.y-this.pos.y-this.displayHeight:0;this.falling=false;this.jumping=false}}}}else{if(this.vel.y<0){if(!m.yprop.isPlatform&&!m.yprop.isLadder){this.jumping=false;this.falling=true;this.vel.y=0}}}}if(m.x){if(this.onslope){if(!m.yprop.isSlope){if(!this.jumping||this.falling){this.checkSlope(m);console.log("xslope");this.falling=false;this.jumping=false}}}else{if(!m.xprop.isPlatform&&!m.xprop.isLadder){if(m.xprop.isBreakable&&this.canBreakTile){me.game.currentLevel.clearTile(m.xtile.row,m.xtile.col);if(this.onTileBreak){this.onTileBreak()}}else{this.vel.x=0}}}}this.updateFlickering();if((this.vel.x!=0)||(this.vel.y!=0)){this.pos.add(this.vel);if((this.onslope&&!this.jumping)||this.onladder){this.vel.y=0}return true}return false},updateFlickering:function(){if(this.flickering){this.flickerTimer-=me.timer.tick;if(this.flickerTimer<0){if(this.flickercb){this.flickercb()}this.flicker(-1)}else{this.visible=!this.visible}}},flicker:function(m,o){this.flickerTimer=m;if(this.flickerTimer<0){this.flickering=false;this.visible=true;this.flickercb=null}else{if(!this.flickering){this.flickercb=o;this.flickering=true}}}});g.me.ObjectEntity=d;var f=d.extend({init:function(m,s,q,o){this.parent(m,s,q,o);this.collisionEnable=true;this.collidable=true;this.type=me.game.COLLECTABLE_OBJECT}});g.me.CollectableEntity=f;var k=d.extend({init:function(o,s,q,m){this.parent(o,s,b);this.pos=new me.Vector2d(o,s);this.collisionBox=new me.Rect(this.pos,q,m);this.collidable=true;this.isEntity=true;this.visible=true},draw:function(m){if(me.debug.renderHitBox){this.collisionBox.draw(m)}},update:function(){return false}});g.me.InvisibleEntity=k;var j=k.extend({init:function(o,t,q,m,s){this.parent(o,t,q,m);this.nextlevel=s},goTo:function(o){var m=o||this.nextlevel;me.levelDirector.loadLevel(m)},onCollision:function(){this.goTo()}});g.me.LevelEntity=j})(window);(function(g,e){removepath=/^.*(\\|\/|\:)/;removeext=/\.[^\.]*$/;var b={COLLISION_MAP:"collision",PARALLAX_MAP:"parallax",};var i=me.Rect.extend({init:function(k,q,l,m,o){this.parent(new me.Vector2d(k*l,q*m),l,m);this.tileId=o;this.row=k;this.col=q}});function j(m,o,l,s,q,k){this.name=m;this.tilewidth=o;this.tileheight=l;this.spacing=s;this.margin=q;this.image=(k)?me.loader.getImage(k.replace(removepath,"").replace(removeext,"")):null;this.type={SOLID:"solid",PLATFORM:"platform",L_SLOPE:"lslope",R_SLOPE:"rslope",LADDER:"ladder",BREAKABLE:"breakable"};this.TileProperties=[];if(this.image){this.hTileCount=~~((this.image.width-this.margin)/(this.tilewidth+this.spacing));this.vTileCount=~~((this.image.height-this.margin)/(this.tileheight+this.spacing))}}j.prototype.getPropertyList=function(){return{isCollidable:false,isSolid:false,isPlatform:false,isSlope:false,isLeftSlope:false,isRightSlope:false,isLadder:false,isBreakable:false}};j.prototype.getTileProperties=function(k){return this.TileProperties[k]};j.prototype.isTileCollidable=function(k){return this.TileProperties[k].isCollidable};j.prototype.drawTile=function(l,k,s,q){var o=this.margin+(this.spacing+this.tilewidth)*(q%this.hTileCount);var m=this.margin+(this.spacing+this.tileheight)*~~(q/this.hTileCount);l.drawImage(this.image,o,m,this.tilewidth,this.tileheight,k,s,this.tilewidth,this.tileheight)};function h(k,l){this.realwidth=k;this.realheight=l;this.isCollisionMap=true}h.prototype.checkCollision=function(o,l){var k=(l.x<0)?o.pos.x+o.colPos.x+l.x:o.pos.x+o.colPos.x+o.width+l.x-1;var q=(l.y<0)?o.pos.y+o.colPos.y+l.y:o.pos.y+o.colPos.y+o.height+l.y;var m={x:false,y:false,tile:e,xprop:{},yprop:{}};if(k<=0||k>=this.realwidth){m.x=true}if(q<=0||q>=this.realheight){m.y=true}return m};function d(k,l,m,o){this.width=k;this.height=l;this.z=o;this.name=null;this.visible=false;this.layerData=null;this.xLUT={};this.yLUT={};this.tileset=m;if(m){this.tilewidth=m.tilewidth;this.tileheight=m.tileheight}else{this.tilewidth=0;this.tileheight=0}this.realwidth=this.width*this.tilewidth;this.realheight=this.height*this.tileheight}d.prototype.initArray=function(l){this.layerData=new Array(this.width);for(var k=0;k<this.width+1;k++){this.layerData[k]=new Array(this.height);for(var m=0;m<this.height+1;m++){this.layerData[k][m]=e}}if(l){for(var k=0;k<this.width*this.tilewidth;k++){this.xLUT[k]=~~(k/this.tilewidth)}for(var m=0;m<this.height*this.tileheight;m++){this.yLUT[m]=~~(m/this.tileheight)}}};d.prototype.getTileId=function(k,m){var l=this.layerData[this.xLUT[~~k]][this.yLUT[~~m]];return l?l.tileId:null};d.prototype.getTile=function(k,l){return this.layerData[this.xLUT[~~k]][this.yLUT[~~l]]};d.prototype.setTile=function(k,m,l){this.layerData[k][m]=new i(k,m,this.tilewidth,this.tileheight,l)};d.prototype.clearTile=function(k,l){this.layerData[k][l]=null};d.prototype.checkCollision=function(o,l){var k=(l.x<0)?o.pos.x+o.colPos.x+l.x:o.pos.x+o.colPos.x+o.width+l.x-1;var q=(l.y<0)?o.pos.y+o.colPos.y+l.y:o.pos.y+o.colPos.y+o.height+l.y;var m={x:false,xtile:e,xprop:{},y:false,ytile:e,yprop:{}};if(k<=0||k>=this.realwidth){m.x=true}else{m.xtile=this.getTile(k,o.pos.y+o.colPos.y+o.height-1);if(m.xtile&&this.tileset.isTileCollidable(m.xtile.tileId)){m.x=true;m.xprop=this.tileset.getTileProperties(m.xtile.tileId)}else{m.xtile=this.getTile(k,o.pos.y+o.colPos.y);if(m.xtile&&this.tileset.isTileCollidable(m.xtile.tileId)){m.x=true;m.xprop=this.tileset.getTileProperties(m.xtile.tileId)}}}m.ytile=this.getTile(o.pos.x+o.colPos.x,q);if(m.ytile&&this.tileset.isTileCollidable(m.ytile.tileId)){m.y=true;m.yprop=this.tileset.getTileProperties(m.ytile.tileId)}else{m.ytile=this.getTile(o.pos.x+o.colPos.x+o.width-1,q);if(m.ytile&&this.tileset.isTileCollidable(m.ytile.tileId)){m.y=true;m.yprop=this.tileset.getTileProperties(m.ytile.tileId)}}return m};d.prototype.update=function(){return false};function f(k,l){this.pos=new me.Vector2d(k,l);this.z=0;this.width=0;this.height=0;this.realwidth=-1;this.realheight=-1;this.tilewidth=0;this.tileheight=0;this.tileset=[];this.mapLayers=[];this.objectGroups=[];this.initialized=false}f.prototype.reset=function(){this.tileset=[];this.mapLayers=[];this.objectGroups=[];this.initialized=false};f.prototype.getObjectGroupByName=function(k){return this.objectGroups[k]};f.prototype.getObjectGroups=function(){return this.objectGroups};f.prototype.getLayerByName=function(k){var m=null;k=k.trim().toLowerCase();for(var l=this.mapLayers.length;l--;){if(this.mapLayers[l].name.contains(k)){m=this.mapLayers[l];break}}if((k.contains(b.COLLISION_MAP))&&(m==null)){m=new h(me.game.currentLevel.realwidth,me.game.currentLevel.realheight)}return m};f.prototype.clearTile=function(k,m){for(var l=this.mapLayers.length;l--;){if(this.mapLayers[l].visible||this.mapLayers[l].isCollisionMap){this.mapLayers[l].clearTile(k,m)}}};f.prototype.addTo=function(k){if(this.visible){k.add(this)}for(var l=this.mapLayers.length;l--;){if(this.mapLayers[l].visible){k.add(this.mapLayers[l])}}};f.prototype.update=function(){return false};var a=(function(){var m={};var k={};var l=null;m.reset=function(){};m.addLevel=function(o){console.log("no level loader defined")};m.addTMXLevel=function(o,q){if(k[o]==null){k[o]=new me.TMXTileMap(o,0,0)}if(q){q()}};m.loadLevel=function(o){if(k[o]===e){console.log("level %s not found",o);return}if(k[o] instanceof me.TMXTileMap){me.state.pause();me.game.reset();k[o].reset();k[o].load();l=o;me.game.loadTMXLevel(k[l]);me.state.resume()}else{console.log("no level loader defined")}};m.getCurrentLevelId=function(){return l},m.reloadLevel=function(){return m.loadLevel(l)},m.nextLevel=function(){if(l+1<k.length){return m.loadLevel(l+1)}else{return false}};m.previousLevel=function(){if(l-1>=0){return m.loadLevel(l-1)}else{return false}};m.goToLevel=function(o){m.loadLevel(o)};return m})();g.me.Tile=i;g.me.TileSet=j;g.me.TiledLayer=d;g.me.TileMap=f;g.me.LevelConstants=b;g.me.levelDirector=a})(window);(function(B,l){var R="map",C="name",w="value",G="version",O="orientation",J="width",H="height",F="opacity",q="tilewidth",a="tileheight",s="firstgid",h="gid",x="tile",y="id",o="data",u="compression",k="encoding",e="base64",Q="spacing",P="margin",v="properties",m="property",N="image",g="source",j="visible",E="tileset",M="layer",K="objectgroup",t="object",A="x",z="y",J="width",H="height";function f(W,V){var T=V.getElementsByTagName(v)[0];if(T){var S=T.getElementsByTagName(m);for(var U=0;U<S.length;U++){L(W,S[U])}}}function L(S,V){var U=me.XMLParser.getStringAttribute(V,C);var T=me.XMLParser.getStringAttribute(V,w);if(!T||T.isBoolean()){T=T?(T=="true"):true}else{if(T.isNumeric()){T=parseInt(T)}}S[U]=T}function I(T,S,U){me.TileMap.call(this,S,U);this.xmlMap=me.loader.getXML(T);if(!this.xmlMap){alert(T+" map not found");return}this.version="";this.orientation="";this.tileMapCanvas=null}I.prototype=new me.TileMap();I.prototype.load=function(){if(this.initialized){return}var X=0,Z=1;me.XMLParser.parseFromString(this.xmlMap);var aa=me.XMLParser.getAllTagElements();for(var Y=0;Y<aa.length;Y++){var V=aa.item(Y).nodeName;switch(V){case R:var T=aa.item(Y);this.version=me.XMLParser.getStringAttribute(T,G);this.orientation=me.XMLParser.getStringAttribute(T,O);this.width=me.XMLParser.getIntAttribute(T,J);this.height=me.XMLParser.getIntAttribute(T,H);this.tilewidth=me.XMLParser.getIntAttribute(T,q);this.tileheight=me.XMLParser.getIntAttribute(T,a);this.realwidth=this.width*this.tilewidth;this.realheight=this.height*this.tileheight;this.z=X++;if(this.orientation!="orthogonal"){alert("%s type tilemap not supported!",this.orientation);return}f(this,T);if(this.background_color){this.visible=true;this.background_color=me.utils.HexToRGB(this.background_color)}else{this.visible=false}break;case E:this.tileset.push(new D(aa.item(Y)));break;case M:var U=me.XMLParser.getStringAttribute(aa.item(Y),C);if(U.contains(me.LevelConstants.COLLISION_MAP)){this.mapLayers.push(new d(aa.item(Y),this.tileset,X++))}else{if(U.contains(me.LevelConstants.PARALLAX_MAP)){var W=(me.XMLParser.getIntAttribute(aa.item(Y),j,1)==1);if(W){var ab={};f(ab,aa.item(Y));parallax_layer=this.getLayerByName(me.LevelConstants.PARALLAX_MAP);if(!parallax_layer){parallax_layer=new me.ParallaxBackgroundEntity(X);this.mapLayers.push(parallax_layer)}parallax_layer.addLayer(ab.imagesrc,Z++,X++)}}else{this.mapLayers.push(new d(aa.item(Y),this.tileset,X++));X++}}break;case K:var S=me.XMLParser.getStringAttribute(aa.item(Y),C);this.objectGroups.push(new i(S,aa.item(Y),X++));break}}me.XMLParser.free();this.initialized=true};I.prototype.draw=function(S){me.video.clearSurface(S,this.background_color)};function D(U){this.firstgid=me.XMLParser.getIntAttribute(U,s);me.TileSet.call(this,me.XMLParser.getStringAttribute(U,C),me.XMLParser.getIntAttribute(U,q),me.XMLParser.getIntAttribute(U,a),me.XMLParser.getIntAttribute(U,Q,0),me.XMLParser.getIntAttribute(U,P,0),U.getElementsByTagName(N)[0].getAttribute(g));var S=U.getElementsByTagName(x);for(var V=0;V<S.length;V++){var W=me.XMLParser.getIntAttribute(S[V],y);var T=this.getPropertyList();f(T,S[V]);T.isSolid=T.type?T.type.toLowerCase()==this.type.SOLID:false;T.isPlatform=T.type?T.type.toLowerCase()==this.type.PLATFORM:false;T.isLeftSlope=T.type?T.type.toLowerCase()==this.type.L_SLOPE:false;T.isRightSlope=T.type?T.type.toLowerCase()==this.type.R_SLOPE:false;T.isBreakable=T.type?T.type.toLowerCase()==this.type.BREAKABLE:false;T.isLadder=T.type?T.type.toLowerCase()==this.type.LADDER:false;T.isSlope=T.isLeftSlope||T.isRightSlope;T.isCollidable=T.isSolid||T.isPlatform||T.isSlope||T.isLadder||T.isBreakable;this.TileProperties[W]=T}}D.prototype=new me.TileSet();function d(T,X,V){me.TiledLayer.call(this,me.XMLParser.getIntAttribute(T,J),me.XMLParser.getIntAttribute(T,H),X[0],V);this.layerInvalidated=true;this.name=me.XMLParser.getStringAttribute(T,C);this.visible=(me.XMLParser.getIntAttribute(T,j,1)==1);this.opacity=me.XMLParser.getFloatAttribute(T,F,1);f(this,T);this.isCollisionMap=(this.name.contains(me.LevelConstants.COLLISION_MAP));if(this.isCollisionMap){this.visible=false;if(X[1]){this.tileset=X[1]}}this.vp=me.game.viewport;var W=T.getElementsByTagName(o)[0];var U=me.XMLParser.getStringAttribute(W,k);var S=me.XMLParser.getStringAttribute(W,u);if(this.visible||this.isCollisionMap){this.layerSurface=me.video.createCanvasSurface(this.width*this.tilewidth,this.height*this.tileheight);this.layerCanvas=this.layerSurface.canvas;if(this.opacity>0&&this.opacity<1){this.layerSurface.globalAlpha=this.opacity}this.initArray(this.isCollisionMap);this.fillArray(W,U,S)}}d.prototype=new me.TiledLayer();d.prototype.fillArray=function(Y,W,U){if(U!=null){alert(U+" compressed tilemap not supported!");return}if(W==e){var X=me.utils.decodeNumBase64(Y.childNodes[0].nodeValue)}else{var X=Y.getElementsByTagName(x)}var T=0;for(var Z=0;Z<this.height;Z++){for(var S=0;S<this.width;S++){if(W==e){var V=X[T]|X[T+1]<<8|X[T+2]<<16|X[T+3]<<24;T+=4}else{var V=me.XMLParser.getIntAttribute(X[T++],h)}if(V>0){this.setTile(S,Z,V-this.tileset.firstgid);if(this.visible){this.tileset.drawTile(this.layerSurface,S*this.tilewidth,Z*this.tileheight,this.layerData[S][Z].tileId)}}else{}}}};d.prototype.clearTile=function(S,T){me.TiledLayer.prototype.clearTile.call(this,S,T);this.layerSurface.clearRect(S*this.tilewidth,T*this.tileheight,this.tilewidth,this.tileheight)};d.prototype.draw=function(T,S,U){T.drawImage(this.layerCanvas,this.vp.pos.x,this.vp.pos.y,this.vp.width,this.vp.height,S,U,this.vp.width,this.vp.height)};function i(T,S,W){this.objects=[];this.name=T;this.width=me.XMLParser.getIntAttribute(S,J);this.height=me.XMLParser.getIntAttribute(S,H);this.z=W;var V=S.getElementsByTagName(t);for(var U=0;U<V.length;U++){this.objects.push(new b(V[U],W))}}i.prototype.getObjectCount=function(){return this.objects.length};i.prototype.getObjectByIndex=function(S){return this.objects[S]};function b(S,T){this.name=me.XMLParser.getStringAttribute(S,C);this.x=me.XMLParser.getIntAttribute(S,A);this.y=me.XMLParser.getIntAttribute(S,z);this.z=T;this.width=me.XMLParser.getIntAttribute(S,J,0);this.height=me.XMLParser.getIntAttribute(S,H,0);f(this,S)}b.prototype.getObjectPropertyByName=function(S){return this[S]};B.me.TMXTileMap=I})(window);
/*!
 * Tween JS
 * https://github.com/sole/Tween.js
 *
 * @author sole / http://soledadpenades.com
 * @author mr.doob / http://mrdoob.com
 * @author Robert Eisele / http://www.xarg.org
 * @author Philippe / http://philippe.elsass.me
 * @author Robert Penner / http://www.robertpenner.com/easing_terms_of_use.html
 */
(function(a,b){var d=function(h){var q=h,o={},k={},l={},i=1000,m=0,e=null,s=d.Easing.Linear.EaseNone,g=null,j=null,f=null;this.to=function(t,v){if(v!==null){i=v}for(var u in t){if(q[u]===null){continue}l[u]=t[u]}return this};this.start=function(){me.game.add(this,999);e=me.timer.getTime()+m;for(var t in l){if(q[t]===null){continue}o[t]=q[t];k[t]=l[t]-q[t]}return this};this.stop=function(){this.destroy();return this};this.delay=function(t){m=t;return this};this.easing=function(t){s=t;return this};this.chain=function(t){g=t};this.onUpdate=function(t){j=t;return this};this.onComplete=function(t){f=t;return this};this.update=function(){var v,t,u;var w=me.timer.getTime();if(w<e){return true}t=(w-e)/i;t=t>1?1:t;u=s(t);for(v in k){q[v]=o[v]+k[v]*u}if(j!==null){j.call(q,u)}if(t==1){this.destroy();if(f!==null){f.call(q)}if(g!==null){g.start()}return false}return true};this.destroy=function(){me.game.remove(this)}};d.Easing={Linear:{},Quadratic:{},Cubic:{},Quartic:{},Quintic:{},Sinusoidal:{},Exponential:{},Circular:{},Elastic:{},Back:{},Bounce:{}};d.Easing.Linear.EaseNone=function(e){return e};d.Easing.Quadratic.EaseIn=function(e){return e*e};d.Easing.Quadratic.EaseOut=function(e){return -e*(e-2)};d.Easing.Quadratic.EaseInOut=function(e){if((e*=2)<1){return 0.5*e*e}return -0.5*(--e*(e-2)-1)};d.Easing.Cubic.EaseIn=function(e){return e*e*e};d.Easing.Cubic.EaseOut=function(e){return --e*e*e+1};d.Easing.Cubic.EaseInOut=function(e){if((e*=2)<1){return 0.5*e*e*e}return 0.5*((e-=2)*e*e+2)};d.Easing.Quartic.EaseIn=function(e){return e*e*e*e};d.Easing.Quartic.EaseOut=function(e){return -(--e*e*e*e-1)};d.Easing.Quartic.EaseInOut=function(e){if((e*=2)<1){return 0.5*e*e*e*e}return -0.5*((e-=2)*e*e*e-2)};d.Easing.Quintic.EaseIn=function(e){return e*e*e*e*e};d.Easing.Quintic.EaseOut=function(e){return(e=e-1)*e*e*e*e+1};d.Easing.Quintic.EaseInOut=function(e){if((e*=2)<1){return 0.5*e*e*e*e*e}return 0.5*((e-=2)*e*e*e*e+2)};d.Easing.Sinusoidal.EaseIn=function(e){return -Math.cos(e*Math.PI/2)+1};d.Easing.Sinusoidal.EaseOut=function(e){return Math.sin(e*Math.PI/2)};d.Easing.Sinusoidal.EaseInOut=function(e){return -0.5*(Math.cos(Math.PI*e)-1)};d.Easing.Exponential.EaseIn=function(e){return e==0?0:Math.pow(2,10*(e-1))};d.Easing.Exponential.EaseOut=function(e){return e==1?1:-Math.pow(2,-10*e)+1};d.Easing.Exponential.EaseInOut=function(e){if(e==0){return 0}if(e==1){return 1}if((e*=2)<1){return 0.5*Math.pow(2,10*(e-1))}return 0.5*(-Math.pow(2,-10*(e-1))+2)};d.Easing.Circular.EaseIn=function(e){return -(Math.sqrt(1-e*e)-1)};d.Easing.Circular.EaseOut=function(e){return Math.sqrt(1- --e*e)};d.Easing.Circular.EaseInOut=function(e){if((e/=0.5)<1){return -0.5*(Math.sqrt(1-e*e)-1)}return 0.5*(Math.sqrt(1-(e-=2)*e)+1)};d.Easing.Elastic.EaseIn=function(f){var g,e=0.1,h=0.4;if(f==0){return 0}if(f==1){return 1}if(!h){h=0.3}if(!e||e<1){e=1;g=h/4}else{g=h/(2*Math.PI)*Math.asin(1/e)}return -(e*Math.pow(2,10*(f-=1))*Math.sin((f-g)*(2*Math.PI)/h))};d.Easing.Elastic.EaseOut=function(f){var g,e=0.1,h=0.4;if(f==0){return 0}if(f==1){return 1}if(!h){h=0.3}if(!e||e<1){e=1;g=h/4}else{g=h/(2*Math.PI)*Math.asin(1/e)}return(e*Math.pow(2,-10*f)*Math.sin((f-g)*(2*Math.PI)/h)+1)};d.Easing.Elastic.EaseInOut=function(f){var g,e=0.1,h=0.4;if(f==0){return 0}if(f==1){return 1}if(!h){h=0.3}if(!e||e<1){e=1;g=h/4}else{g=h/(2*Math.PI)*Math.asin(1/e)}if((f*=2)<1){return -0.5*(e*Math.pow(2,10*(f-=1))*Math.sin((f-g)*(2*Math.PI)/h))}return e*Math.pow(2,-10*(f-=1))*Math.sin((f-g)*(2*Math.PI)/h)*0.5+1};d.Easing.Back.EaseIn=function(e){var f=1.70158;return e*e*((f+1)*e-f)};d.Easing.Back.EaseOut=function(e){var f=1.70158;return(e=e-1)*e*((f+1)*e+f)+1};d.Easing.Back.EaseInOut=function(e){var f=1.70158*1.525;if((e*=2)<1){return 0.5*(e*e*((f+1)*e-f))}return 0.5*((e-=2)*e*((f+1)*e+f)+2)};d.Easing.Bounce.EaseIn=function(e){return 1-d.Easing.Bounce.EaseOut(1-e)};d.Easing.Bounce.EaseOut=function(e){if((e/=1)<(1/2.75)){return 7.5625*e*e}else{if(e<(2/2.75)){return 7.5625*(e-=(1.5/2.75))*e+0.75}else{if(e<(2.5/2.75)){return 7.5625*(e-=(2.25/2.75))*e+0.9375}else{return 7.5625*(e-=(2.625/2.75))*e+0.984375}}}};d.Easing.Bounce.EaseInOut=function(e){if(e<0.5){return d.Easing.Bounce.EaseIn(e*2)*0.5}return d.Easing.Bounce.EaseOut(e*2-1)*0.5+0.5};a.me.Tween=d})(window);